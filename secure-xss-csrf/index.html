<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" integrity="sha256-no0c5ccDODBwp+9hSmV5VvPpKwHCpbVzXHexIkupM6U=" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js" integrity="sha256-a5YRB27CcBwBFcT5EF/f3E4vzIqyHrSR878nseNYw64=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"scarboroughcoral.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="XSS、CSRF">
<meta property="og:type" content="article">
<meta property="og:title" content="Web安全系列：XSS和CSRF">
<meta property="og:url" content="https://scarboroughcoral.github.io/secure-xss-csrf/index.html">
<meta property="og:site_name" content="李明岳的网络日志">
<meta property="og:description" content="XSS、CSRF">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-18T16:33:05.000Z">
<meta property="article:modified_time" content="2021-08-24T14:14:51.251Z">
<meta property="article:author" content="李明岳">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://scarboroughcoral.github.io/secure-xss-csrf/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://scarboroughcoral.github.io/secure-xss-csrf/","path":"secure-xss-csrf/","title":"Web安全系列：XSS和CSRF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Web安全系列：XSS和CSRF | 李明岳的网络日志</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">李明岳的网络日志</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XSS"><span class="nav-number">2.</span> <span class="nav-text">XSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81XSS%E5%88%86%E7%B1%BB"><span class="nav-number">2.1.</span> <span class="nav-text">常见XSS分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="nav-number">2.2.</span> <span class="nav-text">XSS注入方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS%E9%81%BF%E5%85%8D"><span class="nav-number">2.3.</span> <span class="nav-text">XSS避免</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS-Game%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="nav-number">2.4.</span> <span class="nav-text">XSS Game实验内容</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#level1"><span class="nav-number">2.4.1.</span> <span class="nav-text">level1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level2"><span class="nav-number">2.4.2.</span> <span class="nav-text">level2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level3"><span class="nav-number">2.4.3.</span> <span class="nav-text">level3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level4"><span class="nav-number">2.4.4.</span> <span class="nav-text">level4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level5"><span class="nav-number">2.4.5.</span> <span class="nav-text">level5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#level6"><span class="nav-number">2.4.6.</span> <span class="nav-text">level6</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSRF"><span class="nav-number">3.</span> <span class="nav-text">CSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%E4%B8%8A%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-number">3.1.</span> <span class="nav-text">维基百科上的例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%84%E9%98%B2"><span class="nav-number">3.2.</span> <span class="nav-text">预防</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">李明岳</p>
  <div class="site-description" itemprop="description">一个假的全栈工程师</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ScarboroughCoral" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ScarboroughCoral" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://scarboroughcoral.github.io/secure-xss-csrf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李明岳">
      <meta itemprop="description" content="一个假的全栈工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李明岳的网络日志">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Web安全系列：XSS和CSRF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-18 16:33:05" itemprop="dateCreated datePublished" datetime="2019-11-18T16:33:05+00:00">2019-11-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-24 14:14:51" itemprop="dateModified" datetime="2021-08-24T14:14:51+00:00">2021-08-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <div class="note primary"><p>XSS、CSRF</p>
</div>

<span id="more"></span>

<hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Web应用的安全问题也是一个web开发人员需要了解的事，今天我们就来看一看常见的两种安全问题，<code>XSS</code>和<code>CSRF</code>。</p>
<p><strong>因为对安全问题不够熟悉，读者如果发现问题请右下角小窗私聊或文章右上角修改按钮github提交pr。</strong></p>
<p>大体内容如下：</p>
<ul>
<li>XSS<ul>
<li>什么是XSS</li>
<li>XSS分类</li>
<li>XSS实例</li>
<li>XSS避免</li>
</ul>
</li>
<li>CSRF<ul>
<li>什么是CSRF</li>
<li>CSRF实例</li>
<li>CSRF避免</li>
</ul>
</li>
</ul>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><blockquote>
<p>Cross-site scripting (XSS) bugs are one of the most common and dangerous types of vulnerabilities in Web applications.These nasty buggers can allow your enemies to steal or modify user data in your apps.</p>
</blockquote>
<p>通过这个<a target="_blank" rel="noopener" href="https://xss-game.appspot.com/">小实验（游戏）</a>，你就可以大致了解一下XSS是一个什么东西了。</p>
<p>认识的一个大佬也写过一篇<a target="_blank" rel="noopener" href="https://orzbox.github.io/our-tech/#/articles/XSS-Explain-1">XSS文章</a>，可以当做参考。</p>
<p>做了一下这个实验，勉勉强强算是通关了。</p>
<p>在这个XSS Game中做了什么？<strong>整体感觉就是从客户端找漏洞（看网页源码，JS、HTML），然后通过表单或者url注入脚本或者一些其他第三方脚本。</strong></p>
<blockquote>
<p>Cross-site scripting carried out on websites accounted for roughly 84% of all security vulnerabilities documented by Symantec up until 2007.（Wikipedia）</p>
</blockquote>
<h3 id="常见XSS分类"><a href="#常见XSS分类" class="headerlink" title="常见XSS分类"></a>常见XSS分类</h3><ul>
<li>Stored XSS Attacks：持久注入，注入数据库</li>
<li>Reflected XSS Attacks:注入的数据会由服务器返回或者直接跳转到另一个页面显示</li>
<li>DOM-based XSS Attacks：修改DOM</li>
</ul>
<h3 id="XSS注入方式"><a href="#XSS注入方式" class="headerlink" title="XSS注入方式"></a>XSS注入方式</h3><ul>
<li>表单注入</li>
<li>URL注入</li>
<li>引用外部脚本</li>
</ul>
<h3 id="XSS避免"><a href="#XSS避免" class="headerlink" title="XSS避免"></a>XSS避免</h3><ul>
<li>同源策略</li>
<li>白名单策略（内容安全策略，Content Safe Policy）</li>
<li>表单验证</li>
<li>拼凑字符串时验证来自querystring的变量</li>
</ul>
<h3 id="XSS-Game实验内容"><a href="#XSS-Game实验内容" class="headerlink" title="XSS Game实验内容"></a>XSS Game实验内容</h3><p>大体记录一下实验内容吧。</p>
<h4 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h4><p>一个提交表单的页面，输入数据data并提交。<br>观察py代码可以看到他会将data渲染到页面内，那么我可以输入以下内容：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>OK，Hello World to XSS就完成了。</p>
<h4 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h4><p>一个发送评论的页面。<br>通过观察源码，发现他也会将输入的数据data直接显示出来。</p>
<p>但是这时候使用level1中的方法已经不管用了（可能是因为页面已经加载完了，无法执行script脚本</p>
<p>但是我可以通过如下代码来实现，插入一个无效图片，通过onerror方法来执行脚本。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>level2 is over！</p>
<h4 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h4><p>没有可输入的表单，但是可以通过URL输入，有个哈希参数用于图片显示。</p>
<p>通过观察源码，发现他将url输入的数字编号通过img标签进行拼接了（num就是我们输入的数）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html += &quot;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;/static/level3/cloud&quot; + num + &quot;.jpg&#x27;</span> /&gt;</span>&quot;;</span><br></pre></td></tr></table></figure>

<p>那我们可以通过如下代码来封闭标签：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">https://xss-game.appspot.com/level3/frame#x&#x27; onerror=&#x27;alert(&quot;xss&quot;)&#x27;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>完成！</p>
<h4 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h4><p>一个输入表单数据timer，然后提交。</p>
<p>通过查看py代码，发现他的数据渲染部分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;/static/loading.gif&quot; onload=&quot;startTimer(&#x27;&#123;&#123; timer &#125;&#125;&#x27;);&quot; /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们利用封闭标签，输入如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;);alert(&#x27;xss</span><br><span class="line"></span><br><span class="line">模板渲染后：onload=&quot;startTimer(&#x27;&#x27;);alert(&#x27;xss&#x27;);&quot;</span><br></pre></td></tr></table></figure>
<p>这样就完成了。</p>
<h4 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h4><p>观察源码有一个a标签是通过模板渲染的:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; next &#125;&#125;&quot;</span>&gt;</span>Next &gt;&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里使用a标签的伪协议来完成，我们可以输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://xss-game.appspot.com/level5/frame/signup?next=javascript:alert(1)</span><br><span class="line"></span><br><span class="line">模板渲染后：<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(1)&quot;</span>&gt;</span>Next &gt;&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h4><p>可以通过URL请求其他文件，可以通过data协议（<code>data:text/plain,alert(&#39;s&#39;)</code>）创建一个简单的文本。</p>
<p>结果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xss-game.appspot.com/level6/frame#data:text/plain,alert(&#x27;xss&#x27;)</span><br></pre></td></tr></table></figure>

<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><blockquote>
<p>跨站请求伪造（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。跟跨网站脚本（XSS）相比，XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户网页浏览器的信任。（Wikipedia）</p>
</blockquote>
<p>顾名思义，就是攻击者伪造请求。假如说用户在A网站登录了，这时候浏览器保存了登录信息，这段时间内用户又访问了B网站，B网站内存在一个A网站则请求（这个请求是攻击者伪造的），这样就属于跨站请求伪造。</p>
<h3 id="维基百科上的例子"><a href="#维基百科上的例子" class="headerlink" title="维基百科上的例子"></a>维基百科上的例子</h3><p>前提是没有同源策略，Attackers才能使用银行的登录信息。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">假如一家银行用以运行转账操作的URL地址如下： http://www.examplebank.com/withdraw?account=AccoutName&amp;amount=1000&amp;for=PayeeName</span><br><span class="line"></span><br><span class="line">那么，一个恶意攻击者可以在另一个网站上放置如下代码： <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://www.examplebank.com/withdraw?account=Alice&amp;amount=1000&amp;for=Badman&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">如果有账户名为Alice的用户访问了恶意站点，而她之前刚访问过银行不久，登录信息尚未过期，那么她就会损失1000资金。</span><br><span class="line"></span><br><span class="line">这种恶意的网址可以有很多种形式，藏身于网页中的许多地方。此外，攻击者也不需要控制放置恶意网址的网站。例如他可以将这种地址藏在论坛，博客等任何用户生成内容的网站中。这意味着如果服务端没有合适的防御措施的话，用户即使访问熟悉的可信网站也有受攻击的危险。</span><br><span class="line"></span><br><span class="line">透过例子能够看出，攻击者并不能通过CSRF攻击来直接获取用户的账户控制权，也不能直接窃取用户的任何信息。他们能做到的，是欺骗用户浏览器，让其以用户的名义运行操作。</span><br></pre></td></tr></table></figure>

<p>因为同源策略不允许读取其他源的cookie，所以如何完成攻击呢？<br>如果可以，使用XSS攻击加CSRF攻击就可以很好的完成。首先使用stored的XSS注入到数据库，然后显示到银行的网页，此时victim不小心点击的这个标签，就会发起请求了。</p>
<h3 id="预防"><a href="#预防" class="headerlink" title="预防"></a>预防</h3><ul>
<li>检查Referer字段，发起请求的来源。存在客户端伪造Referer的可能</li>
<li>添加校验token（伪随机数）</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://xss-game.appspot.com/">Warning: You are entering the XSS game area</a></li>
<li><a target="_blank" rel="noopener" href="https://orzbox.github.io/our-tech/#/articles/XSS-Explain-1">XSS跨站脚本攻击探讨总结</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Cross-site_scripting">Cross-site scripting</a></li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0">跨站请求伪造</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Security/" rel="tag"><i class="fa fa-tag"></i> Security</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/css-align-center/" rel="prev" title="CSS系列：对齐">
                  <i class="fa fa-chevron-left"></i> CSS系列：对齐
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/js-taskqueue/" rel="next" title="用JavaScript实现一个任务队列">
                  用JavaScript实现一个任务队列 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李明岳</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>



  <script class="next-config" data-name="nprogress" type="application/json">{"enable":true,"spinner":true}</script>
  <script src="/js/third-party/nprogress.js"></script>

  





</body>
</html>
